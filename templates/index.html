<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>innate c3 | ai discoverability analyzer</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #005e30;
            --secondary-color: #f5f2e9;
            --accent-color: #00a651;
            --text-color: #333333;
            --warning-color: #ff9500;
            --danger-color: #ff3b30;
        }
        body {
            font-family: 'IBM Plex Sans', sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
        }
        .divider {
            height: 2px;
            background-color: var(--primary-color);
            margin: 2rem 0;
        }
        h1, h2, h3, h4 {
            color: var(--primary-color);
        }
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #004020;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 94, 48, 0.3);
        }
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        .btn-secondary {
            background-color: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            transition: all 0.3s ease;
        }
        .btn-secondary:hover {
            background-color: var(--primary-color);
            color: white;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
            transition: all 0.3s ease;
        }
        .card:hover {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
            color: white;
        }
        .spinner {
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 5px solid white;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .hidden {
            display: none !important;
        }
        .score-circle {
            width: 180px;
            height: 180px;
            margin: 0 auto 20px;
            position: relative;
        }
        .score-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 56px;
            font-weight: 700;
            color: var(--primary-color);
        }
        .metric-card {
            background-color: #f8f8f8;
            border-left: 4px solid var(--primary-color);
            transition: all 0.3s ease;
        }
        .metric-card:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .good { color: #00a651; }
        .warning { color: #ff9500; }
        .bad { color: #ff3b30; }
        .error-message {
            background-color: #fee;
            color: #c33;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            white-space: pre-line;
        }
        .sub-score {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            font-weight: 600;
            margin: 0.25rem;
        }
        .content-metric {
            background-color: #f0f9ff;
            border-left: 4px solid #0ea5e9;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-radius: 0.25rem;
        }
        .recommendation-section {
            margin-bottom: 1.5rem;
        }
        #recommendations h3 {
            color: var(--primary-color);
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            font-size: 1.25rem;
            font-weight: 600;
        }
        #recommendations p {
            margin-bottom: 1rem;
            line-height: 1.6;
        }
        #recommendations ul {
            margin-bottom: 1rem;
        }
        #recommendations li {
            margin-bottom: 0.5rem;
            line-height: 1.6;
        }
        #recommendations strong {
            font-weight: 600;
            color: #1a1a1a;
        }
        .priority-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .priority-high {
            background-color: #fee2e2;
            color: #dc2626;
        }
        .priority-medium {
            background-color: #fef3c7;
            color: #d97706;
        }
        .priority-low {
            background-color: #dbeafe;
            color: #2563eb;
        }
        input[type="url"] {
            border: 2px solid #e5e7eb;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        input[type="url"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 94, 48, 0.1);
        }
        .workflow-phase {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }
        .workflow-phase:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08);
        }
        .workflow-task {
            display: flex;
            align-items: start;
            margin-bottom: 0.75rem;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }
        .workflow-task:hover {
            background-color: #f3f4f6;
        }
        .task-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #d1d5db;
            border-radius: 4px;
            margin-right: 12px;
            flex-shrink: 0;
            margin-top: 2px;
        }
        .competitor-row {
            display: flex;
            align-items: center;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
            background-color: #f9fafb;
            transition: all 0.3s ease;
        }
        .competitor-row:hover {
            background-color: #f3f4f6;
        }
        .score-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-weight: 700;
            font-size: 1.25rem;
            margin-right: 1rem;
        }
        .score-good {
            background-color: #d1fae5;
            color: #065f46;
        }
        .score-warning {
            background-color: #fed7aa;
            color: #92400e;
        }
        .score-bad {
            background-color: #fee2e2;
            color: #991b1b;
        }
        .cta-banner {
            background: linear-gradient(135deg, var(--primary-color) 0%, #004020 100%);
            color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            text-align: center;
            margin-top: 2rem;
        }
        .cta-banner h3 {
            color: white;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        .cta-banner p {
            opacity: 0.9;
            margin-bottom: 1.5rem;
        }
        .emoji-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        .gap-indicator {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            background-color: #fef3c7;
            color: #92400e;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
            margin: 0.25rem;
        }
        .opportunity-card {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border: 1px solid #a7f3d0;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        /* Expandable sections */
        .expand-toggle {
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            color: var(--primary-color);
            font-size: 0.875rem;
            margin-left: 0.5rem;
            transition: all 0.2s ease;
        }
        .expand-toggle:hover {
            color: var(--accent-color);
        }
        .expand-toggle svg {
            width: 16px;
            height: 16px;
            margin-left: 4px;
            transition: transform 0.2s ease;
        }
        .expand-toggle.expanded svg {
            transform: rotate(180deg);
        }
        .expandable-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            margin-top: 0.5rem;
        }
        .expandable-content.expanded {
            max-height: 500px;
        }
        .explainer-box {
            background-color: #f3f4f6;
            border-left: 3px solid var(--accent-color);
            padding: 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            line-height: 1.5;
        }
        
        /* Tooltips */
        .tooltip-trigger {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            background-color: #e5e7eb;
            color: #6b7280;
            border-radius: 50%;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: help;
            margin-left: 0.25rem;
            position: relative;
        }
        .tooltip-trigger:hover .tooltip-content {
            display: block;
        }
        .tooltip-content {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #1f2937;
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: normal;
            white-space: normal;
            width: 250px;
            z-index: 10;
            margin-bottom: 0.25rem;
            line-height: 1.4;
        }
        .tooltip-content::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 4px solid transparent;
            border-top-color: #1f2937;
        }
    </style>
</head>
<body class="min-h-screen p-8">
    <div class="max-w-6xl mx-auto">
        <div class="divider"></div>
        <div class="flex justify-between items-center">
            <h1 class="text-3xl font-bold mb-4 mt-4">innate c3 | ai discoverability analyzer</h1>
            <a href="https://innatec3.com/home#contact" class="btn-primary font-bold py-2 px-4 rounded">
                Consulting Services
            </a>
        </div>
        <div class="divider"></div>
        
        <div class="card px-8 pt-6 pb-8 mb-4">
            <h2 class="text-2xl font-bold mb-6">🔍 Analyze Your Website's AI Visibility</h2>
            <p class="text-gray-600 mb-6">Discover how AI systems see your content and get actionable recommendations to improve your visibility in AI-powered search results.</p>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="urlInput">
                        Your Website URL
                    </label>
                    <div class="flex gap-4">
                        <input type="url" id="urlInput" placeholder="https://example.com" 
                               class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        <button id="analyzeBtn" onclick="analyzeURL()" 
                                class="btn-primary font-bold py-3 px-8 rounded-lg focus:outline-none focus:shadow-outline">
                            Analyze
                        </button>
                    </div>
                </div>
                
                
                <div id="errorMsg" class="error-message hidden"></div>
            </div>
        </div>
        
        <!-- Results Section (Hidden by Default) -->
        <div id="results" class="hidden">
            <!-- Score Section -->
            <div class="card px-8 pt-6 pb-8 mb-4 relative fade-in">
                <!-- Share Button in upper right corner -->
                <button id="shareBtn" onclick="shareResults()" class="btn-primary font-bold py-2 px-4 rounded absolute top-4 right-4" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block mr-2">
                        <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
                        <polyline points="16 6 12 2 8 6"></polyline>
                        <line x1="12" y1="2" x2="12" y2="15"></line>
                    </svg>
                    Share Results
                </button>
                
                <h2 class="text-2xl font-bold mb-6 text-center">🎯 AI Readiness Score</h2>
                <div class="score-circle">
                    <svg width="180" height="180">
                        <circle cx="90" cy="90" r="85" fill="none" stroke="#e0e0e0" stroke-width="10"/>
                        <circle id="scoreCircle" cx="90" cy="90" r="85" fill="none" stroke="#005e30" stroke-width="10"
                                stroke-dasharray="534" stroke-dashoffset="534"
                                transform="rotate(-90 90 90)"
                                style="transition: stroke-dashoffset 1s ease-in-out"/>
                    </svg>
                    <div class="score-value" id="scoreValue">0</div>
                </div>
                <p class="text-center text-xl font-semibold" id="scoreLabel">Loading...</p>
                <p class="text-center text-gray-600 text-lg" id="scoreDescription"></p>
                
                <!-- Sub-scores -->
                <div class="text-center mt-6" id="subScores">
                    <!-- Sub-scores will be inserted here -->
                </div>
            </div>
            
            
            <!-- Content Optimization Workflow -->
            <div id="workflowSection" class="card px-8 pt-6 pb-8 mb-4 fade-in">
                <h2 class="text-2xl font-bold mb-6">🚀 Your Content Optimization Roadmap</h2>
                <p class="text-gray-600 mb-6">Follow this step-by-step plan to improve your AI visibility:</p>
                <div id="workflowContent">
                    <!-- Workflow will be inserted here -->
                </div>
            </div>
            
            <!-- Comprehensive Score Breakdown -->
            <div class="card px-8 pt-6 pb-8 mb-4 fade-in">
                <h2 class="text-2xl font-bold mb-6">📊 Comprehensive Score Breakdown</h2>
                
                <!-- Technical SEO Section -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 flex items-center">
                        🔧 Technical SEO
                        <span class="ml-2 text-sm font-normal text-gray-600" id="technicalTotal"></span>
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="technicalMetrics">
                        <!-- Technical metrics will be inserted here -->
                    </div>
                </div>
                
                <!-- Content Optimization Section -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 flex items-center">
                        ✍️ Content Optimization
                        <span class="ml-2 text-sm font-normal text-gray-600" id="contentTotal"></span>
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="contentMetrics">
                        <!-- Content metrics will be inserted here -->
                    </div>
                </div>
                
                <!-- Penalties Section -->
                <div id="penaltiesSection" class="hidden">
                    <h3 class="text-xl font-semibold mb-4 text-red-600 flex items-center">
                        ⚠️ Penalties Applied
                        <span class="tooltip-trigger">?
                            <span class="tooltip-content">Penalties are deducted from your total score for missing critical elements that significantly impact AI discoverability. These are must-have features that AI systems expect to find.</span>
                        </span>
                    </h3>
                    <div id="penaltiesList" class="space-y-2">
                        <!-- Penalties will be inserted here -->
                    </div>
                </div>
                
                <!-- Total Score Summary -->
                <div class="mt-6 pt-6 border-t-2 border-gray-200">
                    <div class="flex justify-between items-center">
                        <span class="text-xl font-semibold">Total Score</span>
                        <span class="text-2xl font-bold" id="totalScoreDisplay"></span>
                    </div>
                </div>
            </div>
            
            
            <!-- CTA Banner -->
            <div class="cta-banner fade-in">
                <h3>Ready to Accelerate Your AI Optimization?</h3>
                <p>This roadmap would take your team 3-6 months to implement. Let's discuss how to achieve results in 6-8 weeks.</p>
                <a href="https://innatec3.com/home#contact" class="btn-secondary font-bold py-3 px-8 rounded-lg inline-block">
                    Schedule Strategy Session
                </a>
            </div>
        </div>
        
        <!-- Loading Overlay (Hidden by Default) -->
        <div id="loading" class="loading-overlay hidden">
            <div class="spinner"></div>
            <p class="text-xl">🤖 Analyzing your website...</p>
            <p class="text-sm mt-2">This may take a moment.</p>
        </div>
    </div>
    
    <!-- Footer -->
    <div class="max-w-6xl mx-auto mt-12 mb-4 text-center">
        <div class="divider"></div>
        <p class="text-sm text-gray-600">
            for more information about innate c3, visit <a href="https://innatec3.com" target="_blank" class="text-primary-600 hover:underline" style="color: var(--primary-color);">innatec3.com</a>
        </p>
    </div>

    {% if shared_result %}
    <script type="application/json" id="sharedResultData">{{ shared_result | tojson | safe }}</script>
    {% endif %}
    
    <script type="text/javascript">
        // Check if we have a shared result to display
        let sharedResult = null;
        const sharedResultElement = document.getElementById('sharedResultData');
        if (sharedResultElement) {
            try {
                sharedResult = JSON.parse(sharedResultElement.textContent);
            } catch (e) {
                console.error('Error parsing shared result:', e);
            }
        }
        
        if (sharedResult) {
            // Display the shared result
            window.addEventListener('DOMContentLoaded', function() {
                displayResults(sharedResult);
                // Update the URL input with the analyzed URL
                document.getElementById('urlInput').value = sharedResult.analysis.url;
            });
        }
        
        function analyzeURL() {
            const urlInput = document.getElementById('urlInput');
            const url = urlInput.value.trim();
            
            if (!url) {
                showError('Please enter a URL to analyze');
                return;
            }

            // Reset UI
            hideError();
            document.getElementById('results').classList.add('hidden');
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('analyzeBtn').disabled = true;

            // Make API call
            fetch('/analyze', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ url: url })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    showError(data.error);
                } else {
                    displayResults(data);
                    // Update URL with shareable link if we have an ID
                    if (data.id) {
                        const shareableUrl = `${window.location.origin}/results/${data.id}`;
                        window.history.pushState({}, '', shareableUrl);
                    }
                }
            })
            .catch(error => {
                showError('An error occurred while analyzing the URL. Please try again.');
                console.error('Error:', error);
            })
            .finally(() => {
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('analyzeBtn').disabled = false;
            });
        }

        function displayResults(data) {
            // Show results section
            document.getElementById('results').classList.remove('hidden');
            
            // Show share button
            document.getElementById('shareBtn').style.display = 'inline-block';

            // Display score
            const score = data.score;
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreValue = document.getElementById('scoreValue');
            const scoreLabel = document.getElementById('scoreLabel');
            const scoreDescription = document.getElementById('scoreDescription');

            scoreValue.textContent = score;
            
            // Animate score circle
            const circumference = 2 * Math.PI * 85;
            const offset = circumference - (score / 100) * circumference;
            setTimeout(() => {
                scoreCircle.style.strokeDashoffset = offset;
            }, 100);

            // Set score color and label with emojis
            if (score >= 80) {
                scoreCircle.style.stroke = '#00a651';
                scoreLabel.textContent = '🌟 Excellent';
                scoreDescription.textContent = 'Your content is well-optimized for AI systems';
            } else if (score >= 60) {
                scoreCircle.style.stroke = '#ff9500';
                scoreLabel.textContent = '👍 Good';
                scoreDescription.textContent = 'Your content has room for improvement';
            } else {
                scoreCircle.style.stroke = '#ff3b30';
                scoreLabel.textContent = '⚠️ Needs Work';
                scoreDescription.textContent = 'Significant improvements recommended';
            }

            // Display workflow if available
            if (data.workflow) {
                displayWorkflow(data.workflow);
            }

            // Competitive analysis removed

            // Display score breakdown if available
            if (data.score_breakdown) {
                displayScoreBreakdown(data.score_breakdown);
            }
            
            // Display sub-scores
            if (data.score_breakdown && data.score_breakdown.technical_score !== undefined && data.score_breakdown.content_score !== undefined) {
                const subScoresDiv = document.getElementById('subScores');
                subScoresDiv.innerHTML = `
                    <div class="sub-score" style="background-color: #e0f2fe; color: #0369a1;">
                        🔧 Technical SEO: ${data.score_breakdown.technical_score}/50
                    </div>
                    <div class="sub-score" style="background-color: #f0fdf4; color: #15803d;">
                        ✍️ Content Optimization: ${data.score_breakdown.content_score}/50
                    </div>
                `;
            }

            // Recommendations removed

            // Scroll to results
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }
        
        function displayWorkflow(workflow) {
            const workflowContent = document.getElementById('workflowContent');
            workflowContent.innerHTML = '';
            
            // Task explainers
            const taskExplainers = {
                'Add meta descriptions to all pages': {
                    title: 'What are meta descriptions?',
                    content: 'Meta descriptions are short summaries (150-160 characters) that appear under your page title in search results. Think of them as your webpage\'s elevator pitch.',
                    example: 'Example: "Learn how to bake perfect chocolate chip cookies with our step-by-step guide. Includes tips for chewy, crispy, or cake-like textures."'
                },
                'Add alt text to': {
                    title: 'What is alt text?',
                    content: 'Alt text (alternative text) describes images for screen readers and search engines. It\'s like a caption that explains what\'s in the picture when the image can\'t be seen.',
                    example: 'Example: Instead of "IMG_1234.jpg", use "Woman kneading sourdough bread dough on marble countertop"'
                },
                'Create robots.txt file': {
                    title: 'What is robots.txt?',
                    content: 'A robots.txt file is like a "welcome mat" for search engines. It tells AI crawlers which parts of your site they can visit and which parts are off-limits.',
                    example: 'Example: You might allow access to your blog but block access to your admin pages.'
                },
                'Generate and submit sitemap.xml': {
                    title: 'What is a sitemap?',
                    content: 'A sitemap is like a table of contents for your website. It lists all your pages in one place, making it easier for AI to discover and understand your content.',
                    example: 'Example: It\'s a file that says "Here are all 50 pages on my site, when they were last updated, and how important each one is."'
                },
                'Add author bylines and credentials': {
                    title: 'Why author information matters',
                    content: 'AI systems trust content more when they know who wrote it. Author bylines with credentials show expertise and build credibility.',
                    example: 'Example: "By Dr. Sarah Johnson, PhD in Nutrition, 15 years experience in dietary research"'
                },
                'Implement structured data markup': {
                    title: 'What is structured data?',
                    content: 'Structured data is like adding labels to your content that AI can easily read. It\'s special code that explicitly tells AI what type of content you have.',
                    example: 'Example: Marking up a recipe with cooking time, ingredients, and ratings so AI knows it\'s a recipe, not just text about food.'
                },
                'Create comprehensive FAQ sections': {
                    title: 'Why FAQ sections matter',
                    content: 'AI loves Q&A format because it matches how people ask questions. FAQs provide direct answers that AI can easily extract and share.',
                    example: 'Example: "Q: How long does shipping take? A: Standard shipping takes 3-5 business days within the US."'
                },
                'Rewrite promotional content with factual focus': {
                    title: 'Factual vs. promotional content',
                    content: 'AI prefers objective facts over marketing language. Replace superlatives with specific data and features.',
                    example: 'Instead of: "The best software ever!" Use: "Software that processes 10,000 transactions per second with 99.9% uptime"'
                },
                'Add statistics, research citations, and data': {
                    title: 'Why data matters to AI',
                    content: 'AI systems prioritize content backed by evidence. Statistics, research citations, and concrete data make your content more authoritative.',
                    example: 'Example: "According to a 2024 Stanford study, 73% of users prefer mobile-first designs (Smith et al., 2024)"'
                },
                'Develop topical authority content strategy': {
                    title: 'What is topical authority?',
                    content: 'Topical authority means becoming the go-to source on a specific subject by creating comprehensive, interconnected content that covers all aspects of a topic.',
                    example: 'Example: If you sell running shoes, create content about training plans, injury prevention, nutrition for runners, race strategies, etc.'
                },
                'Build knowledge graph-aligned content': {
                    title: 'What are knowledge graphs?',
                    content: 'Knowledge graphs show how different concepts relate to each other. AI uses these connections to understand context and provide better answers.',
                    example: 'Example: Connecting "chocolate chip cookies" to related concepts like "baking temperature," "cookie texture," "ingredient substitutions," etc.'
                },
                'Create Wikipedia-style neutral content': {
                    title: 'Academic writing style',
                    content: 'AI models are heavily trained on Wikipedia. Writing in a neutral, fact-based style similar to Wikipedia makes your content more AI-friendly.',
                    example: 'Example: "The company was founded in 2010" instead of "Our amazing journey began in 2010"'
                },
                'Implement advanced schema strategies': {
                    title: 'Advanced schema markup',
                    content: 'Beyond basic structured data, advanced schemas help AI understand complex relationships, events, products, and services on your site.',
                    example: 'Example: Using Event schema for webinars, Product schema for e-commerce items, or HowTo schema for tutorials.'
                }
            };
            
            // Helper function to create expandable task
            function createExpandableTask(task, explainerKey) {
                const taskId = 'task-' + Math.random().toString(36).substr(2, 9);
                const taskDiv = document.createElement('div');
                taskDiv.className = 'workflow-task';
                
                // Find matching explainer
                let explainer = null;
                for (const key in taskExplainers) {
                    if (task.task.includes(key)) {
                        explainer = taskExplainers[key];
                        break;
                    }
                }
                
                taskDiv.innerHTML = `
                    <div class="task-checkbox"></div>
                    <div class="flex-1">
                        <div class="flex items-start justify-between">
                            <div class="flex-1">
                                <p class="font-medium">${task.task}</p>
                                <p class="text-sm text-gray-600 mt-1">${task.impact}</p>
                            </div>
                            ${explainer ? `
                                <span class="expand-toggle" onclick="toggleExplainer('${taskId}')">
                                    Learn more
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                    </svg>
                                </span>
                            ` : ''}
                        </div>
                        ${explainer ? `
                            <div id="${taskId}" class="expandable-content">
                                <div class="explainer-box mt-2">
                                    <h5 class="font-semibold mb-2">${explainer.title}</h5>
                                    <p class="mb-2">${explainer.content}</p>
                                    <p class="text-sm italic">${explainer.example}</p>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;
                
                return taskDiv;
            }
            
            // Quick Wins
            if (workflow.quick_wins && workflow.quick_wins.length > 0) {
                const quickWinsDiv = document.createElement('div');
                quickWinsDiv.className = 'workflow-phase';
                quickWinsDiv.innerHTML = `
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <span class="emoji-icon mr-2">⚡</span>
                        Phase 1: Quick Wins (2-4 hours)
                        <span class="priority-badge priority-high">+15 points</span>
                    </h3>
                `;
                
                workflow.quick_wins.forEach(task => {
                    quickWinsDiv.appendChild(createExpandableTask(task));
                });
                
                workflowContent.appendChild(quickWinsDiv);
            }
            
            // Deep Optimizations
            if (workflow.deep_optimizations && workflow.deep_optimizations.length > 0) {
                const deepOptDiv = document.createElement('div');
                deepOptDiv.className = 'workflow-phase';
                deepOptDiv.innerHTML = `
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <span class="emoji-icon mr-2">🔨</span>
                        Phase 2: Content Restructuring (2-3 days)
                        <span class="priority-badge priority-medium">+20 points</span>
                    </h3>
                `;
                
                workflow.deep_optimizations.forEach(task => {
                    deepOptDiv.appendChild(createExpandableTask(task));
                });
                
                workflowContent.appendChild(deepOptDiv);
            }
            
            // Strategic Initiatives
            if (workflow.strategic_initiatives && workflow.strategic_initiatives.length > 0) {
                const strategicDiv = document.createElement('div');
                strategicDiv.className = 'workflow-phase';
                strategicDiv.innerHTML = `
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <span class="emoji-icon mr-2">🚀</span>
                        Phase 3: Strategic Transformation
                        <span class="priority-badge priority-low">+25 points</span>
                    </h3>
                `;
                
                workflow.strategic_initiatives.forEach(task => {
                    strategicDiv.appendChild(createExpandableTask(task));
                });
                
                workflowContent.appendChild(strategicDiv);
                
                // Add CTA after strategic initiatives
                const ctaDiv = document.createElement('div');
                ctaDiv.className = 'mt-4 p-4 bg-gray-50 rounded-lg text-center';
                ctaDiv.innerHTML = `
                    <p class="text-gray-700 mb-3">
                        <strong>This is complex work.</strong> Let's discuss how I can accelerate your AI optimization journey.
                    </p>
                    <a href="https://innatec3.com/home#contact" class="btn-primary font-bold py-2 px-6 rounded inline-block">
                        Get Expert Help
                    </a>
                `;
                workflowContent.appendChild(ctaDiv);
            }
        }
        
        // Toggle function for expandable content
        function toggleExplainer(taskId) {
            const content = document.getElementById(taskId);
            const toggle = content.previousElementSibling.querySelector('.expand-toggle');
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                toggle.classList.remove('expanded');
            } else {
                content.classList.add('expanded');
                toggle.classList.add('expanded');
            }
        }
        
        
        function displayScoreBreakdown(breakdown) {
            // Tooltips for technical terms
            const categoryTooltips = {
                'Title & Meta Description': 'The page title appears in browser tabs and search results. Meta descriptions are short summaries shown under the title in search results.',
                'Heading Structure': 'H1-H6 tags organize content hierarchically. H1 is the main title, H2 for major sections, H3 for subsections, etc.',
                'Image Alt Text': 'Alternative text describes images for screen readers and search engines when images can\'t be displayed.',
                'Structured Data': 'Special code (JSON-LD) that helps AI understand your content type (recipes, products, events, etc.)',
                'Semantic HTML': 'HTML tags that describe content meaning (article, nav, header) rather than just appearance.',
                'Data Organization': 'Tables organize data in rows/columns. Forms collect user input.',
                'Crawlability Files': 'robots.txt tells AI what to crawl. sitemap.xml lists all your pages.',
                'Social Media Tags': 'Open Graph (used by Facebook, LinkedIn, etc.) and Twitter/X Card tags control how your links appear when shared on social media. Instagram and TikTok use Open Graph tags.',
                'Canonical Tag': 'Tells search engines which version of a page is the "main" one to avoid duplicate content.',
                'Language & Charset': 'HTML lang declares the page language. Charset defines text encoding (usually UTF-8).',
                'Content Readability': 'How easy your content is to read and understand, measured by sentence length and word complexity.',
                'Content Tone & Factuality': 'Balance between promotional marketing language and objective, fact-based content.',
                'Answer Optimization': 'How well content is structured to directly answer questions (FAQs, Q&A format).',
                'Credibility & Authority': 'Signals that establish expertise: author info, citations, quality external links.',
                'Content Brevity': 'Conciseness and clarity - avoiding filler words and redundant phrases.'
            };
            
            // Define which categories belong to technical vs content
            const technicalCategories = ['Title & Meta Description', 'Heading Structure', 'Image Alt Text', 
                                       'Structured Data', 'Semantic HTML', 'Data Organization', 
                                       'Crawlability Files', 'Social Media Tags', 'Canonical Tag', 
                                       'Language & Charset'];
            const contentCategories = ['Content Readability', 'Content Tone & Factuality', 
                                     'Answer Optimization', 'Credibility & Authority', 'Content Brevity'];
            
            // Separate categories
            const technicalMetrics = breakdown.categories.filter(cat => technicalCategories.includes(cat.name));
            const contentMetrics = breakdown.categories.filter(cat => contentCategories.includes(cat.name));
            
            // Calculate totals
            const technicalEarned = technicalMetrics.reduce((sum, cat) => sum + cat.earned, 0);
            const technicalPossible = technicalMetrics.reduce((sum, cat) => sum + cat.possible, 0);
            const contentEarned = contentMetrics.reduce((sum, cat) => sum + cat.earned, 0);
            const contentPossible = contentMetrics.reduce((sum, cat) => sum + cat.possible, 0);
            
            // Update section totals
            document.getElementById('technicalTotal').textContent = `(${technicalEarned}/${technicalPossible} points)`;
            document.getElementById('contentTotal').textContent = `(${contentEarned}/${contentPossible} points)`;
            
            // Function to create metric card
            function createMetricCard(category) {
                const percentage = category.possible > 0 ? Math.round((category.earned / category.possible) * 100) : 0;
                const borderColor = percentage >= 80 ? '#00a651' : percentage >= 50 ? '#ff9500' : '#ff3b30';
                const tooltip = categoryTooltips[category.name];
                
                const card = document.createElement('div');
                card.className = 'metric-card p-4 rounded';
                card.style.borderLeftColor = borderColor;
                card.innerHTML = `
                    <div class="font-semibold text-sm mb-2 flex items-center">
                        ${category.name}
                        ${tooltip ? `
                            <span class="tooltip-trigger">?
                                <span class="tooltip-content">${tooltip}</span>
                            </span>
                        ` : ''}
                    </div>
                    <div class="text-2xl font-bold mb-1" style="color: ${borderColor}">
                        ${category.earned}/${category.possible}
                    </div>
                    <div class="text-xs text-gray-600">${category.details}</div>
                `;
                return card;
            }
            
            // Display technical metrics
            const technicalGrid = document.getElementById('technicalMetrics');
            technicalGrid.innerHTML = '';
            technicalMetrics.forEach(metric => {
                technicalGrid.appendChild(createMetricCard(metric));
            });
            
            // Display content metrics
            const contentGrid = document.getElementById('contentMetrics');
            contentGrid.innerHTML = '';
            contentMetrics.forEach(metric => {
                contentGrid.appendChild(createMetricCard(metric));
            });
            
            // Display penalties if any
            if (breakdown.penalties && breakdown.penalties.length > 0) {
                const penaltiesSection = document.getElementById('penaltiesSection');
                const penaltiesList = document.getElementById('penaltiesList');
                
                penaltiesSection.classList.remove('hidden');
                penaltiesList.innerHTML = '';
                
                breakdown.penalties.forEach(penalty => {
                    const penaltyDiv = document.createElement('div');
                    penaltyDiv.className = 'text-sm text-red-600';
                    penaltyDiv.innerHTML = `• ${penalty.name}: <strong>${penalty.points} points</strong>`;
                    penaltiesList.appendChild(penaltyDiv);
                });
            }
            
            // Update total score display
            document.getElementById('totalScoreDisplay').textContent = `${breakdown.final_score}/100`;
        }
        

        function showError(message) {
            const errorMsg = document.getElementById('errorMsg');
            errorMsg.textContent = message;
            errorMsg.classList.remove('hidden');
        }

        function hideError() {
            document.getElementById('errorMsg').classList.add('hidden');
        }

        // Allow Enter key to submit
        document.getElementById('urlInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                analyzeURL();
            }
        });
        
        function shareResults() {
            const shareUrl = window.location.href;
            
            // Try to use the Web Share API if available
            if (navigator.share) {
                navigator.share({
                    title: 'AI Discoverability Analysis Results',
                    text: `Check out this AI readiness analysis score: ${document.getElementById('scoreValue').textContent}/100`,
                    url: shareUrl
                }).catch(err => {
                    // Fallback to copying to clipboard
                    copyToClipboard(shareUrl);
                });
            } else {
                // Fallback to copying to clipboard
                copyToClipboard(shareUrl);
            }
        }
        
        function copyToClipboard(text) {
            // Create a temporary input element
            const tempInput = document.createElement('input');
            tempInput.value = text;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);
            
            // Show feedback
            const shareBtn = document.getElementById('shareBtn');
            const originalText = shareBtn.innerHTML;
            shareBtn.innerHTML = 'Link Copied!';
            shareBtn.style.backgroundColor = '#00a651';
            
            setTimeout(() => {
                shareBtn.innerHTML = originalText;
                shareBtn.style.backgroundColor = '';
            }, 2000);
        }
    </script>
</body>
</html>
